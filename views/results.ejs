<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resultados de Envío</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .container { background: #f9f9f9; padding: 20px; border-radius: 8px; }
    h1 { color: #3897f0; }
    .result-item { margin: 15px 0; padding: 15px; border-radius: 5px; }
    .success { background-color: #e8f5e9; border-left: 5px solid #4caf50; }
    .error { background-color: #ffebee; border-left: 5px solid #f44336; }
    .message-preview { margin-top: 10px; padding: 10px; background: white; border-radius: 3px; }
    .back-btn { 
      display: inline-block; 
      margin-top: 20px; 
      padding: 10px 20px; 
      background: #3897f0; 
      color: white; 
      text-decoration: none; 
      border-radius: 4px; 
    }
    .back-btn:hover { background: #287abd; }
    .summary { 
      margin: 20px 0; 
      padding: 15px; 
      background: #e3f2fd; 
      border-radius: 5px; 
      display: flex; 
      justify-content: space-between; 
    }
  </style>
</head>
<body>
  <div class="container">
    <% if (error) { %>
      <h1>Error en el Proceso</h1>
      <div class="error result-item">
        <p><strong>Error:</strong> <%= error %></p>
      </div>
    <% } else { %>
      <h1>Resultados para @<%= username %></h1>
      
      <div class="summary">
        <div>
          <strong>Total:</strong> <%= results.length %> usuarios<br>
          <strong>Mensaje:</strong> <%= messageSent %>
        </div>
        <div>
          <strong>Éxitos:</strong> <%= results.filter(r => r.status === 'success').length %><br>
          <strong>Errores:</strong> <%= results.filter(r => r.status === 'error').length %>
        </div>
      </div>
      
      <% results.forEach(result => { %>
        <div class="<%= result.status %> result-item">
          <strong>@<%= result.user %>:</strong> 
          <span style="color: <%= result.status === 'success' ? '#4caf50' : '#f44336' %>">
            <%= result.message %>
          </span>
          <% if (result.sentMessage) { %>
            <div class="message-preview">
              <em>"<%= result.sentMessage %>"</em>
            </div>
          <% } %>
        </div>
      <% }); %>
    <% } %>
    
    <a href="/" class="back-btn">Volver al Inicio</a>
  </div>
</body>
</html>